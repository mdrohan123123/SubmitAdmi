<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ROG TEAM - PREMIUM ADMIN PANEL</title>
  
  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
  
  <!-- Excel Export Library -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  
  <!-- Font Awesome 6 -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      --primary: #667eea;
      --primary-dark: #5a67d8;
      --primary-light: #e6e9ff;
      --secondary: #764ba2;
      --secondary-dark: #6b46a0;
      --success: #10b981;
      --success-dark: #059669;
      --danger: #ef4444;
      --danger-dark: #dc2626;
      --warning: #f59e0b;
      --warning-dark: #d97706;
      --info: #3b82f6;
      --info-dark: #2563eb;
      --dark: #1f2937;
      --darker: #111827;
      --light: #f9fafb;
      --lighter: #ffffff;
      --gray-100: #f3f4f6;
      --gray-200: #e5e7eb;
      --gray-300: #d1d5db;
      --gray-400: #9ca3af;
      --gray-500: #6b7280;
      --gray-600: #4b5563;
      --gray-700: #374151;
      --gray-800: #1f2937;
      --gray-900: #111827;
      --gradient-1: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      --gradient-2: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      --gradient-3: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
      --gradient-4: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
      --shadow-sm: 0 2px 4px rgba(0,0,0,0.05);
      --shadow-md: 0 4px 6px rgba(0,0,0,0.07);
      --shadow-lg: 0 10px 15px rgba(0,0,0,0.1);
      --shadow-xl: 0 20px 25px rgba(0,0,0,0.15);
      --shadow-2xl: 0 25px 50px rgba(0,0,0,0.25);
    }

    body {
      font-family: 'Inter', sans-serif;
      background: #f4f7fc;
      min-height: 100vh;
    }

    /* Glassmorphism Effect */
    .glass {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .glass-dark {
      background: rgba(17, 24, 39, 0.95);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    /* Animations */
    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes pulse {
      0%, 100% {
        transform: scale(1);
      }
      50% {
        transform: scale(1.05);
      }
    }

    @keyframes shimmer {
      0% {
        background-position: -1000px 0;
      }
      100% {
        background-position: 1000px 0;
      }
    }

    .animate-slide-in {
      animation: slideIn 0.5s ease forwards;
    }

    .animate-pulse-slow {
      animation: pulse 3s infinite;
    }

    /* Scrollbar Styling */
    ::-webkit-scrollbar {
      width: 10px;
      height: 10px;
    }

    ::-webkit-scrollbar-track {
      background: var(--gray-100);
      border-radius: 10px;
    }

    ::-webkit-scrollbar-thumb {
      background: var(--gradient-1);
      border-radius: 10px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: var(--primary-dark);
    }

    /* Premium Container */
    .premium-container {
      max-width: 1800px;
      margin: 0 auto;
      padding: 20px;
    }

    /* Premium Header */
    .premium-header {
      background: var(--gradient-1);
      border-radius: 30px;
      padding: 25px 30px;
      margin-bottom: 30px;
      box-shadow: var(--shadow-2xl);
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 20px;
      position: relative;
      overflow: hidden;
    }

    .premium-header::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
      animation: shimmer 10s infinite linear;
    }

    .logo-area {
      display: flex;
      align-items: center;
      gap: 20px;
      position: relative;
      z-index: 1;
    }

    .logo-icon {
      width: 60px;
      height: 60px;
      background: rgba(255,255,255,0.2);
      border-radius: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 30px;
      color: white;
      border: 2px solid rgba(255,255,255,0.3);
      backdrop-filter: blur(5px);
    }

    .logo-text h1 {
      font-size: 28px;
      font-weight: 800;
      color: white;
      margin-bottom: 5px;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
    }

    .logo-text span {
      color: rgba(255,255,255,0.8);
      font-size: 14px;
      font-weight: 500;
    }

    .header-badge {
      background: rgba(255,255,255,0.2);
      backdrop-filter: blur(10px);
      padding: 12px 30px;
      border-radius: 50px;
      color: white;
      font-weight: 600;
      font-size: 16px;
      border: 2px solid rgba(255,255,255,0.3);
      position: relative;
      z-index: 1;
    }

    /* Stats Cards */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .stat-card {
      background: white;
      border-radius: 25px;
      padding: 25px;
      box-shadow: var(--shadow-lg);
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 20px;
      position: relative;
      overflow: hidden;
    }

    .stat-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 5px;
      height: 100%;
      background: var(--gradient-1);
    }

    .stat-card:hover {
      transform: translateY(-5px);
      box-shadow: var(--shadow-2xl);
    }

    .stat-icon {
      width: 60px;
      height: 60px;
      background: var(--gradient-1);
      border-radius: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      color: white;
    }

    .stat-content {
      flex: 1;
    }

    .stat-label {
      color: var(--gray-500);
      font-size: 14px;
      font-weight: 500;
      margin-bottom: 5px;
    }

    .stat-value {
      font-size: 32px;
      font-weight: 800;
      color: var(--gray-800);
      line-height: 1.2;
    }

    .stat-trend {
      font-size: 12px;
      color: var(--success);
      display: flex;
      align-items: center;
      gap: 5px;
      margin-top: 5px;
    }

    /* Control Grid */
    .control-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
      gap: 25px;
      margin-bottom: 30px;
    }

    .premium-card {
      background: white;
      border-radius: 30px;
      padding: 25px;
      box-shadow: var(--shadow-lg);
      transition: all 0.3s ease;
    }

    .premium-card:hover {
      box-shadow: var(--shadow-2xl);
    }

    .card-header {
      display: flex;
      align-items: center;
      gap: 15px;
      margin-bottom: 25px;
      padding-bottom: 15px;
      border-bottom: 2px solid var(--gray-100);
    }

    .card-header i {
      width: 45px;
      height: 45px;
      background: var(--gradient-1);
      border-radius: 15px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      color: white;
    }

    .card-header h3 {
      font-size: 18px;
      font-weight: 700;
      color: var(--gray-800);
    }

    .card-header p {
      color: var(--gray-500);
      font-size: 13px;
      margin-top: 3px;
    }

    /* Toggle Switch Premium */
    .premium-toggle {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 20px;
      background: var(--gradient-1);
      border-radius: 20px;
      margin-bottom: 25px;
      color: white;
    }

    .toggle-info h4 {
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 5px;
    }

    .toggle-info p {
      font-size: 13px;
      opacity: 0.9;
    }

    .toggle-status {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .status-badge {
      padding: 8px 20px;
      border-radius: 30px;
      font-weight: 600;
      font-size: 14px;
    }

    .status-badge.on {
      background: rgba(255,255,255,0.2);
      color: white;
      border: 2px solid rgba(255,255,255,0.3);
    }

    .status-badge.off {
      background: rgba(0,0,0,0.2);
      color: white;
      border: 2px solid rgba(255,255,255,0.2);
    }

    .toggle-btn {
      width: 120px;
      padding: 10px;
      border: none;
      border-radius: 30px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
    }

    .toggle-btn.on {
      background: var(--danger);
      color: white;
    }

    .toggle-btn.off {
      background: var(--success);
      color: white;
    }

    /* Time Settings */
    .time-settings {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-bottom: 25px;
    }

    .time-input-group {
      background: var(--gray-100);
      border-radius: 20px;
      padding: 15px;
    }

    .time-input-group label {
      display: block;
      font-size: 13px;
      font-weight: 600;
      color: var(--gray-600);
      margin-bottom: 10px;
    }

    .time-input-group input[type="time"] {
      width: 100%;
      padding: 12px;
      border: 2px solid transparent;
      border-radius: 15px;
      font-size: 16px;
      font-weight: 600;
      color: var(--gray-800);
      background: white;
      transition: all 0.3s;
    }

    .time-input-group input[type="time"]:focus {
      border-color: var(--primary);
      outline: none;
      box-shadow: 0 0 0 4px var(--primary-light);
    }

    /* Banner Settings */
    .banner-preview {
      background: var(--gradient-1);
      border-radius: 20px;
      padding: 20px;
      margin-bottom: 20px;
      color: white;
      text-align: center;
    }

    .banner-preview h2 {
      font-size: 24px;
      font-weight: 800;
      margin-bottom: 10px;
    }

    .banner-preview p {
      opacity: 0.9;
      font-size: 14px;
    }

    .input-group-premium {
      margin-bottom: 20px;
    }

    .input-group-premium label {
      display: block;
      font-size: 14px;
      font-weight: 600;
      color: var(--gray-700);
      margin-bottom: 8px;
    }

    .input-group-premium input,
    .input-group-premium textarea {
      width: 100%;
      padding: 15px 20px;
      border: 2px solid var(--gray-200);
      border-radius: 20px;
      font-size: 14px;
      transition: all 0.3s;
      background: var(--gray-100);
    }

    .input-group-premium input:focus,
    .input-group-premium textarea:focus {
      border-color: var(--primary);
      outline: none;
      background: white;
      box-shadow: 0 0 0 4px var(--primary-light);
    }

    .premium-btn {
      width: 100%;
      padding: 16px;
      border: none;
      border-radius: 20px;
      background: var(--gradient-1);
      color: white;
      font-weight: 700;
      font-size: 16px;
      cursor: pointer;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }

    .premium-btn:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-xl);
    }

    .premium-btn.small {
      padding: 12px;
      font-size: 14px;
    }

    .premium-btn.success {
      background: var(--gradient-4);
    }

    .premium-btn.warning {
      background: var(--gradient-2);
    }

    .premium-btn.info {
      background: var(--gradient-3);
    }

    /* Quick Actions */
    .quick-actions {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 15px;
      margin-bottom: 15px;
    }

    .action-btn {
      padding: 15px;
      border: none;
      border-radius: 20px;
      font-weight: 600;
      font-size: 14px;
      cursor: pointer;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }

    .action-btn.export {
      background: var(--success);
      color: white;
    }

    .action-btn.delete {
      background: var(--danger);
      color: white;
    }

    .action-btn.user {
      background: var(--info);
      color: white;
    }

    .action-btn:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-lg);
    }

    /* Charts Section */
    .charts-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
      gap: 25px;
      margin-bottom: 30px;
    }

    .chart-card {
      background: white;
      border-radius: 30px;
      padding: 25px;
      box-shadow: var(--shadow-lg);
    }

    .chart-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .chart-header h4 {
      font-size: 16px;
      font-weight: 700;
      color: var(--gray-800);
    }

    .chart-container {
      height: 300px;
      position: relative;
    }

    /* Top Users */
    .top-users-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 20px;
      margin-bottom: 30px;
    }

    .top-user-premium {
      background: white;
      border-radius: 25px;
      padding: 25px;
      box-shadow: var(--shadow-lg);
      text-align: center;
      position: relative;
      overflow: hidden;
    }

    .top-user-premium.gold::before {
      content: 'ü•á';
      position: absolute;
      top: -10px;
      right: -10px;
      font-size: 60px;
      opacity: 0.2;
      transform: rotate(15deg);
    }

    .top-user-premium.silver::before {
      content: 'ü•à';
      position: absolute;
      top: -10px;
      right: -10px;
      font-size: 60px;
      opacity: 0.2;
      transform: rotate(15deg);
    }

    .top-user-premium.bronze::before {
      content: 'ü•â';
      position: absolute;
      top: -10px;
      right: -10px;
      font-size: 60px;
      opacity: 0.2;
      transform: rotate(15deg);
    }

    .user-avatar {
      width: 80px;
      height: 80px;
      background: var(--gradient-1);
      border-radius: 30px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 30px;
      color: white;
      margin: 0 auto 15px;
    }

    .user-name {
      font-size: 16px;
      font-weight: 700;
      color: var(--gray-800);
      margin-bottom: 5px;
    }

    .user-count {
      font-size: 24px;
      font-weight: 800;
      color: var(--primary);
    }

    .user-label {
      color: var(--gray-500);
      font-size: 12px;
    }

    /* Tables */
    .table-section {
      background: white;
      border-radius: 30px;
      padding: 25px;
      box-shadow: var(--shadow-lg);
      margin-bottom: 30px;
    }

    .table-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 20px;
      margin-bottom: 25px;
    }

    .table-title {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .table-title i {
      width: 45px;
      height: 45px;
      background: var(--gradient-1);
      border-radius: 15px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      color: white;
    }

    .table-title h3 {
      font-size: 18px;
      font-weight: 700;
      color: var(--gray-800);
    }

    .table-filters {
      display: flex;
      gap: 15px;
      flex-wrap: wrap;
    }

    .premium-select {
      padding: 12px 25px;
      border: 2px solid var(--gray-200);
      border-radius: 20px;
      font-size: 14px;
      font-weight: 500;
      color: var(--gray-700);
      background: white;
      cursor: pointer;
      min-width: 250px;
    }

    .premium-select:focus {
      border-color: var(--primary);
      outline: none;
    }

    .filter-group {
      display: flex;
      gap: 10px;
    }

    .filter-group .filter-btn {
      padding: 12px 25px;
      border: 2px solid var(--gray-200);
      border-radius: 20px;
      font-weight: 600;
      font-size: 14px;
      cursor: pointer;
      transition: all 0.3s;
      background: white;
    }

    .filter-group .filter-btn.active {
      background: var(--gradient-1);
      color: white;
      border-color: transparent;
    }

    .table-wrapper {
      max-height: 500px;
      overflow-y: auto;
      border-radius: 20px;
      border: 2px solid var(--gray-100);
    }

    .premium-table {
      width: 100%;
      border-collapse: collapse;
    }

    .premium-table th {
      background: var(--gray-100);
      padding: 15px;
      font-size: 14px;
      font-weight: 700;
      color: var(--gray-700);
      position: sticky;
      top: 0;
      z-index: 10;
    }

    .premium-table td {
      padding: 15px;
      border-bottom: 1px solid var(--gray-200);
      font-size: 14px;
    }

    .premium-table tr:hover {
      background: var(--gray-100);
    }

    .token-badge {
      background: var(--gradient-1);
      color: white;
      padding: 5px 12px;
      border-radius: 30px;
      font-size: 12px;
      font-weight: 600;
    }

    .token-badge.unknown {
      background: var(--gray-400);
    }

    .user-badge {
      display: inline-flex;
      align-items: center;
      gap: 5px;
      padding: 5px 12px;
      border-radius: 30px;
      font-size: 12px;
      font-weight: 600;
    }

    .user-badge.total {
      background: var(--primary-light);
      color: var(--primary-dark);
    }

    .user-badge.today {
      background: #d1fae5;
      color: var(--success-dark);
    }

    /* Modal */
    .premium-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(10px);
      z-index: 1000;
      align-items: center;
      justify-content: center;
    }

    .premium-modal.active {
      display: flex;
    }

    .modal-content {
      background: white;
      border-radius: 30px;
      padding: 35px;
      max-width: 450px;
      width: 90%;
      animation: slideIn 0.3s ease;
    }

    .modal-icon {
      width: 70px;
      height: 70px;
      background: var(--gradient-2);
      border-radius: 35px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 30px;
      color: white;
      margin: 0 auto 20px;
    }

    .modal-title {
      font-size: 22px;
      font-weight: 800;
      color: var(--gray-800);
      text-align: center;
      margin-bottom: 10px;
    }

    .modal-text {
      color: var(--gray-600);
      text-align: center;
      margin-bottom: 25px;
      line-height: 1.6;
    }

    .modal-buttons {
      display: flex;
      gap: 15px;
    }

    .modal-btn {
      flex: 1;
      padding: 15px;
      border: none;
      border-radius: 20px;
      font-weight: 700;
      font-size: 16px;
      cursor: pointer;
      transition: all 0.3s;
    }

    .modal-btn.confirm {
      background: var(--danger);
      color: white;
    }

    .modal-btn.cancel {
      background: var(--gray-200);
      color: var(--gray-700);
    }

    .modal-btn:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-lg);
    }

    /* Success Toast */
    .success-toast {
      position: fixed;
      top: 30px;
      right: 30px;
      background: white;
      border-radius: 20px;
      padding: 15px 25px;
      box-shadow: var(--shadow-2xl);
      display: flex;
      align-items: center;
      gap: 15px;
      z-index: 1001;
      transform: translateX(400px);
      transition: transform 0.3s ease;
    }

    .success-toast.show {
      transform: translateX(0);
    }

    .toast-icon {
      width: 40px;
      height: 40px;
      background: var(--success);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 20px;
    }

    .toast-content {
      flex: 1;
    }

    .toast-title {
      font-weight: 700;
      color: var(--gray-800);
      margin-bottom: 3px;
    }

    .toast-message {
      color: var(--gray-600);
      font-size: 13px;
    }

    /* Responsive */
    @media (max-width: 1024px) {
      .control-grid {
        grid-template-columns: 1fr;
      }
      
      .time-settings {
        grid-template-columns: 1fr;
      }
      
      .quick-actions {
        grid-template-columns: 1fr;
      }
      
      .top-users-grid {
        grid-template-columns: 1fr;
      }
    }

    @media (max-width: 768px) {
      .premium-header {
        flex-direction: column;
        text-align: center;
      }
      
      .logo-area {
        flex-direction: column;
      }
      
      .stats-grid {
        grid-template-columns: 1fr;
      }
      
      .table-filters {
        flex-direction: column;
      }
      
      .filter-group {
        flex-wrap: wrap;
      }
    }

    /* Loading Spinner */
    .loading-spinner {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid rgba(255,255,255,0.3);
      border-radius: 50%;
      border-top-color: white;
      animation: spin 1s ease-in-out infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }
  </style>
</head>
<body>
  <div class="premium-container">
    <!-- Premium Header -->
    <div class="premium-header">
      <div class="logo-area">
        <div class="logo-icon">
          <i class="fas fa-crown"></i>
        </div>
        <div class="logo-text">
          <h1>ROG TEAM PREMIUM</h1>
          <span><i class="fas fa-shield-alt"></i> Facebook 2FA Enterprise Control Panel</span>
        </div>
      </div>
      <div class="header-badge">
        <i class="fas fa-bolt"></i> LIVE DASHBOARD <i class="fas fa-circle" style="font-size: 8px; color: #10b981; margin-left: 5px;"></i>
      </div>
    </div>

    <!-- Success Toast -->
    <div class="success-toast" id="successToast">
      <div class="toast-icon">
        <i class="fas fa-check"></i>
      </div>
      <div class="toast-content">
        <div class="toast-title">‡¶∏‡¶´‡¶≤!</div>
        <div class="toast-message" id="toastMessage">‡¶∏‡ßá‡¶ü‡¶ø‡¶Ç‡¶∏ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá</div>
      </div>
    </div>

    <!-- Stats Grid -->
    <div class="stats-grid">
      <div class="stat-card animate-slide-in">
        <div class="stat-icon">
          <i class="fas fa-database"></i>
        </div>
        <div class="stat-content">
          <div class="stat-label">‡¶Æ‡ßã‡¶ü ‡¶∏‡¶æ‡¶¨‡¶Æ‡¶ø‡¶∂‡¶®</div>
          <div class="stat-value" id="totalSubmissions">0</div>
          <div class="stat-trend">
            <i class="fas fa-arrow-up"></i> <span id="totalTrend">+0%</span>
          </div>
        </div>
      </div>

      <div class="stat-card animate-slide-in" style="animation-delay: 0.1s;">
        <div class="stat-icon" style="background: var(--gradient-2);">
          <i class="fas fa-calendar-day"></i>
        </div>
        <div class="stat-content">
          <div class="stat-label">‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶∏‡¶æ‡¶¨‡¶Æ‡¶ø‡¶∂‡¶®</div>
          <div class="stat-value" id="todaySubmissions">0</div>
          <div class="stat-trend">
            <i class="fas fa-clock"></i> <span id="todayTrend">‡¶≤‡¶æ‡¶á‡¶≠</span>
          </div>
        </div>
      </div>

      <div class="stat-card animate-slide-in" style="animation-delay: 0.2s;">
        <div class="stat-icon" style="background: var(--gradient-3);">
          <i class="fas fa-users"></i>
        </div>
        <div class="stat-content">
          <div class="stat-label">‡¶Æ‡ßã‡¶ü ‡¶á‡¶â‡¶ú‡¶æ‡¶∞</div>
          <div class="stat-value" id="totalUsers">0</div>
          <div class="stat-trend">
            <i class="fas fa-user-check"></i> <span id="activeToday">0 ‡¶è‡¶ï‡¶ü‡¶ø‡¶≠</span>
          </div>
        </div>
      </div>

      <div class="stat-card animate-slide-in" style="animation-delay: 0.3s;">
        <div class="stat-icon" style="background: var(--gradient-4);">
          <i class="fas fa-chart-line"></i>
        </div>
        <div class="stat-content">
          <div class="stat-label">‡¶ó‡¶°‡¶º/‡¶∏‡¶∞‡ßç‡¶¨‡ßã‡¶ö‡ßç‡¶ö</div>
          <div class="stat-value"><span id="avgPerUser">0</span>/<span id="maxByUser">0</span></div>
          <div class="stat-trend">
            <i class="fas fa-users"></i> <span id="unknownUsers">0 ‡¶Ü‡¶®‡¶®‡ßã‡¶®</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Control Grid -->
    <div class="control-grid">
      <!-- System Control Card -->
      <div class="premium-card">
        <div class="card-header">
          <i class="fas fa-sliders-h"></i>
          <div>
            <h3>‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ ‡¶ï‡¶®‡ßç‡¶ü‡ßç‡¶∞‡ßã‡¶≤</h3>
            <p>‡¶Æ‡ßá‡¶á‡¶® ‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ ‡¶Ö‡¶®/‡¶Ö‡¶´ ‡¶ì ‡¶ü‡¶æ‡¶á‡¶Æ ‡¶∏‡ßá‡¶ü‡¶ø‡¶Ç‡¶∏</p>
          </div>
        </div>

        <div class="premium-toggle">
          <div class="toggle-info">
            <h4>‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏</h4>
            <p>‡¶™‡ßÅ‡¶∞‡ßã ‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ ‡¶ö‡¶æ‡¶≤‡ßÅ ‡¶¨‡¶æ ‡¶¨‡¶®‡ßç‡¶ß ‡¶ï‡¶∞‡ßÅ‡¶®</p>
          </div>
          <div class="toggle-status">
            <div class="status-badge on" id="statusBadge">‡¶ö‡¶æ‡¶≤‡ßÅ</div>
            <button class="toggle-btn" id="toggleSystemBtn">‡¶¨‡¶®‡ßç‡¶ß ‡¶ï‡¶∞‡ßÅ‡¶®</button>
          </div>
        </div>

        <div class="time-settings">
          <div class="time-input-group">
            <label><i class="far fa-clock"></i> ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶π‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶∏‡¶Æ‡¶Ø‡¶º</label>
            <input type="time" id="startTime" value="19:00">
          </div>
          <div class="time-input-group">
            <label><i class="far fa-clock"></i> ‡¶∂‡ßá‡¶∑ ‡¶π‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶∏‡¶Æ‡¶Ø‡¶º</label>
            <input type="time" id="endTime" value="22:30">
          </div>
        </div>

        <div class="input-group-premium">
          <label><i class="fas fa-message"></i> ‡¶ü‡¶ø‡¶ï‡¶æ‡¶∞ ‡¶Æ‡ßá‡¶∏‡ßá‡¶ú</label>
          <textarea id="tickerMessage" placeholder="‡¶ü‡¶ø‡¶ï‡¶æ‡¶∞ ‡¶Æ‡ßá‡¶∏‡ßá‡¶ú ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®...">üîπ ROG TEAM - FACEBOOK 2FA ‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ üîπ</textarea>
        </div>

        <div class="input-group-premium">
          <label><i class="fas fa-exclamation-triangle"></i> ‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ ‡¶¨‡¶®‡ßç‡¶ß‡ßá‡¶∞ ‡¶ï‡¶æ‡¶∞‡¶£</label>
          <input type="text" id="offReason" placeholder="‡¶Ø‡ßá‡¶Æ‡¶®: ‡¶∞‡ßá‡¶ó‡ßÅ‡¶≤‡¶æ‡¶∞ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ö‡¶≤‡¶õ‡ßá...">
        </div>

        <button class="premium-btn" id="updateSystemBtn">
          <i class="fas fa-save"></i> ‡¶∏‡ßá‡¶ü‡¶ø‡¶Ç‡¶∏ ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡ßÅ‡¶®
        </button>
      </div>

      <!-- Banner & Payment Control Card -->
      <div class="premium-card">
        <div class="card-header">
          <i class="fas fa-paint-brush"></i>
          <div>
            <h3>‡¶¨‡ßç‡¶Ø‡¶æ‡¶®‡¶æ‡¶∞ ‡¶ì ‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶ï‡¶®‡ßç‡¶ü‡ßç‡¶∞‡ßã‡¶≤</h3>
            <p>‡¶¨‡ßç‡¶Ø‡¶æ‡¶®‡¶æ‡¶∞ ‡¶ü‡ßá‡¶ï‡ßç‡¶∏‡¶ü ‡¶ì ‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶Ö‡¶™‡¶∂‡¶® ‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®</p>
          </div>
        </div>

        <div class="banner-preview" id="bannerPreview">
          <h2 id="previewTitle">ROG TEAM - FACEBOOK 2FA</h2>
          <p id="previewSubtitle">‡¶∏‡¶æ‡¶¨‡¶Æ‡¶ø‡¶∂‡¶® ‡¶∏‡¶Æ‡¶Ø‡¶º: ‡¶∏‡¶®‡ßç‡¶ß‡ßç‡¶Ø‡¶æ ‡ß≠‡¶ü‡¶æ - ‡¶∞‡¶æ‡¶§ ‡ßß‡ß¶:‡ß©‡ß¶</p>
        </div>

        <div class="input-group-premium">
          <label><i class="fas fa-heading"></i> ‡¶¨‡ßç‡¶Ø‡¶æ‡¶®‡¶æ‡¶∞ ‡¶ü‡¶æ‡¶á‡¶ü‡ßá‡¶≤</label>
          <input type="text" id="bannerTitle" value="ROG TEAM - FACEBOOK 2FA" placeholder="‡¶¨‡ßç‡¶Ø‡¶æ‡¶®‡¶æ‡¶∞ ‡¶ü‡¶æ‡¶á‡¶ü‡ßá‡¶≤">
        </div>

        <div class="input-group-premium">
          <label><i class="fas fa-tag"></i> ‡¶¨‡ßç‡¶Ø‡¶æ‡¶®‡¶æ‡¶∞ ‡¶∏‡¶æ‡¶¨‡¶ü‡¶æ‡¶á‡¶ü‡ßá‡¶≤</label>
          <input type="text" id="bannerSubtitle" value="‡¶∏‡¶æ‡¶¨‡¶Æ‡¶ø‡¶∂‡¶® ‡¶∏‡¶Æ‡¶Ø‡¶º: ‡¶∏‡¶®‡ßç‡¶ß‡ßç‡¶Ø‡¶æ ‡ß≠‡¶ü‡¶æ - ‡¶∞‡¶æ‡¶§ ‡ßß‡ß¶:‡ß©‡ß¶" placeholder="‡¶¨‡ßç‡¶Ø‡¶æ‡¶®‡¶æ‡¶∞ ‡¶∏‡¶æ‡¶¨‡¶ü‡¶æ‡¶á‡¶ü‡ßá‡¶≤">
        </div>

        <div class="input-group-premium">
          <label><i class="fas fa-credit-card"></i> ‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶Ö‡¶™‡¶∂‡¶® ‡¶ü‡ßá‡¶ï‡ßç‡¶∏‡¶ü</label>
          <input type="text" id="paymentText" value="üí≥ ‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶Æ‡ßá‡¶•‡¶° ‡¶∏‡¶ø‡¶≤‡ßá‡¶ï‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®" placeholder="‡¶™‡ßá‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶Ö‡¶™‡¶∂‡¶® ‡¶ü‡ßá‡¶ï‡ßç‡¶∏‡¶ü">
        </div>

        <div class="input-group-premium">
          <label><i class="fas fa-mobile-alt"></i> ‡¶®‡¶æ‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞ ‡¶™‡ßç‡¶≤‡ßá‡¶∏‡¶π‡ßã‡¶≤‡ßç‡¶°‡¶æ‡¶∞</label>
          <input type="text" id="numberPlaceholder" value="‡ßß‡ßß ‡¶°‡¶ø‡¶ú‡¶ø‡¶ü‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®" placeholder="‡¶®‡¶æ‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞ ‡¶´‡¶ø‡¶≤‡ßç‡¶°‡ßá‡¶∞ ‡¶™‡ßç‡¶≤‡ßá‡¶∏‡¶π‡ßã‡¶≤‡ßç‡¶°‡¶æ‡¶∞">
        </div>

        <button class="premium-btn success" id="updateBannerBtn">
          <i class="fas fa-sync-alt"></i> ‡¶¨‡ßç‡¶Ø‡¶æ‡¶®‡¶æ‡¶∞ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®
        </button>
      </div>

      <!-- Quick Actions Card -->
      <div class="premium-card">
        <div class="card-header">
          <i class="fas fa-bolt"></i>
          <div>
            <h3>‡¶¶‡ßç‡¶∞‡ßÅ‡¶§ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶∂‡¶®</h3>
            <p>‡¶è‡¶ï‡ßç‡¶∏‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶ì ‡¶°‡¶æ‡¶ü‡¶æ ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶ú‡¶Æ‡ßá‡¶®‡ßç‡¶ü</p>
          </div>
        </div>

        <div class="quick-actions">
          <button class="action-btn export" id="exportAllBtn">
            <i class="fas fa-file-excel"></i> ‡¶∏‡¶¨ ‡¶°‡¶æ‡¶ü‡¶æ
          </button>
          <button class="action-btn export" id="exportTodayBtn">
            <i class="fas fa-file-excel"></i> ‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶°‡¶æ‡¶ü‡¶æ
          </button>
          <button class="action-btn user" id="exportUserStatsBtn">
            <i class="fas fa-users"></i> ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶∏
          </button>
          <button class="action-btn delete" id="deleteAllBtn">
            <i class="fas fa-trash"></i> ‡¶∏‡¶¨ ‡¶°‡¶ø‡¶≤‡¶ø‡¶ü
          </button>
        </div>

        <div class="input-group-premium" style="margin-top: 15px;">
          <label><i class="fas fa-chart-simple"></i> ‡¶Ö‡¶ü‡ßã ‡¶∞‡¶ø‡¶´‡ßç‡¶∞‡ßá‡¶∂ (‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶°)</label>
          <input type="number" id="refreshInterval" value="30" min="5" max="300">
        </div>

        <button class="premium-btn info small" id="refreshNowBtn">
          <i class="fas fa-sync-alt"></i> ‡¶è‡¶ñ‡¶®‡¶á ‡¶∞‡¶ø‡¶´‡ßç‡¶∞‡ßá‡¶∂ ‡¶ï‡¶∞‡ßÅ‡¶®
        </button>
      </div>
    </div>

    <!-- Charts Grid -->
    <div class="charts-grid">
      <div class="chart-card">
        <div class="chart-header">
          <h4><i class="fas fa-chart-pie"></i> ‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶∏‡¶æ‡¶¨‡¶Æ‡¶ø‡¶∂‡¶® (‡¶ò‡¶®‡ßç‡¶ü‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ‡¶á‡¶ú)</h4>
        </div>
        <div class="chart-container">
          <canvas id="hourlyChart"></canvas>
        </div>
      </div>

      <div class="chart-card">
        <div class="chart-header">
          <h4><i class="fas fa-chart-bar"></i> ‡¶ü‡¶™ ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶ö‡¶æ‡¶∞‡ßç‡¶ü</h4>
        </div>
        <div class="chart-container">
          <canvas id="topUsersChart"></canvas>
        </div>
      </div>
    </div>

    <!-- Top Users -->
    <div class="top-users-grid">
      <div class="top-user-premium gold">
        <div class="user-avatar">
          <i class="fas fa-crown"></i>
        </div>
        <div class="user-name" id="top1Name">-</div>
        <div class="user-count" id="top1Count">0</div>
        <div class="user-label">‡¶Æ‡ßã‡¶ü ‡¶∏‡¶æ‡¶¨‡¶Æ‡¶ø‡¶∂‡¶®</div>
      </div>

      <div class="top-user-premium silver">
        <div class="user-avatar" style="background: var(--gradient-2);">
          <i class="fas fa-medal"></i>
        </div>
        <div class="user-name" id="top2Name">-</div>
        <div class="user-count" id="top2Count">0</div>
        <div class="user-label">‡¶Æ‡ßã‡¶ü ‡¶∏‡¶æ‡¶¨‡¶Æ‡¶ø‡¶∂‡¶®</div>
      </div>

      <div class="top-user-premium bronze">
        <div class="user-avatar" style="background: var(--gradient-3);">
          <i class="fas fa-award"></i>
        </div>
        <div class="user-name" id="top3Name">-</div>
        <div class="user-count" id="top3Count">0</div>
        <div class="user-label">‡¶Æ‡ßã‡¶ü ‡¶∏‡¶æ‡¶¨‡¶Æ‡¶ø‡¶∂‡¶®</div>
      </div>
    </div>

    <!-- User Stats Table -->
    <div class="table-section">
      <div class="table-header">
        <div class="table-title">
          <i class="fas fa-users"></i>
          <div>
            <h3>‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶ø‡¶∏‡ßç‡¶ü‡¶ø‡¶ï‡ßç‡¶∏</h3>
            <p style="color: var(--gray-500); font-size: 13px;">‡¶∏‡¶ï‡¶≤ ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡ßá‡¶∞ ‡¶∏‡¶æ‡¶¨‡¶Æ‡¶ø‡¶∂‡¶® ‡¶π‡¶ø‡¶∏‡ßç‡¶ü‡ßã‡¶∞‡¶ø</p>
          </div>
        </div>
        <button class="action-btn user" id="exportUserStatsExcel">
          <i class="fas fa-file-excel"></i> ‡¶è‡¶ï‡ßç‡¶∏‡ßá‡¶≤ ‡¶è‡¶ï‡ßç‡¶∏‡¶™‡ßã‡¶∞‡ßç‡¶ü
        </button>
      </div>

      <div class="table-wrapper">
        <table class="premium-table">
          <thead>
            <tr>
              <th>#</th>
              <th>‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶ü‡ßã‡¶ï‡ßá‡¶®</th>
              <th>‡¶Æ‡ßã‡¶ü ‡¶∏‡¶æ‡¶¨‡¶Æ‡¶ø‡¶∂‡¶®</th>
              <th>‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶∏‡¶æ‡¶¨‡¶Æ‡¶ø‡¶∂‡¶®</th>
              <th>‡¶∏‡¶∞‡ßç‡¶¨‡¶∂‡ßá‡¶∑ ‡¶∏‡¶æ‡¶¨‡¶Æ‡¶ø‡¶∂‡¶®</th>
              <th>‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶∂‡¶®</th>
            </tr>
          </thead>
          <tbody id="userStatsBody">
            <tr>
              <td colspan="6" style="text-align: center; padding: 50px;">
                <i class="fas fa-spinner fa-spin" style="font-size: 30px; color: var(--primary);"></i>
                <p style="margin-top: 15px; color: var(--gray-500);">‡¶°‡¶æ‡¶ü‡¶æ ‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</p>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Data Table -->
    <div class="table-section">
      <div class="table-header">
        <div class="table-title">
          <i class="fas fa-table"></i>
          <div>
            <h3>‡¶∏‡¶æ‡¶¨‡¶Æ‡¶ø‡¶∂‡¶® ‡¶°‡¶æ‡¶ü‡¶æ</h3>
            <p style="color: var(--gray-500); font-size: 13px;">‡¶∏‡¶ï‡¶≤ ‡¶∏‡¶æ‡¶¨‡¶Æ‡¶ø‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü‡ßá‡¶∞ ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ</p>
          </div>
        </div>
        <div class="table-filters">
          <select class="premium-select" id="userFilter">
            <option value="all">‡¶∏‡¶¨ ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡ßá‡¶∞ ‡¶°‡¶æ‡¶ü‡¶æ</option>
          </select>
          <div class="filter-group">
            <button class="filter-btn active" data-filter="all">‡¶∏‡¶¨</button>
            <button class="filter-btn" data-filter="today">‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞</button>
          </div>
          <button class="action-btn export" id="exportFilteredBtn">
            <i class="fas fa-download"></i> ‡¶´‡¶ø‡¶≤‡ßç‡¶ü‡¶æ‡¶∞‡¶° ‡¶è‡¶ï‡ßç‡¶∏‡¶™‡ßã‡¶∞‡ßç‡¶ü
          </button>
        </div>
      </div>

      <div class="table-wrapper">
        <table class="premium-table">
          <thead>
            <tr>
              <th>#</th>
              <th>UID</th>
              <th>‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶°</th>
              <th>2FA KEY</th>
              <th>‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶ü‡ßã‡¶ï‡ßá‡¶®</th>
              <th>‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ ‡¶ì ‡¶∏‡¶Æ‡¶Ø‡¶º</th>
            </tr>
          </thead>
          <tbody id="tableBody">
            <tr>
              <td colspan="6" style="text-align: center; padding: 50px;">
                <i class="fas fa-spinner fa-spin" style="font-size: 30px; color: var(--primary);"></i>
                <p style="margin-top: 15px; color: var(--gray-500);">‡¶°‡¶æ‡¶ü‡¶æ ‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</p>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- Delete Modal -->
  <div class="premium-modal" id="deleteModal">
    <div class="modal-content">
      <div class="modal-icon">
        <i class="fas fa-exclamation-triangle"></i>
      </div>
      <h3 class="modal-title">‡¶∏‡¶¨ ‡¶°‡¶æ‡¶ü‡¶æ ‡¶°‡¶ø‡¶≤‡¶ø‡¶ü?</h3>
      <p class="modal-text">‡¶Ü‡¶™‡¶®‡¶ø ‡¶ï‡¶ø ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§? ‡¶è‡¶á ‡¶ï‡¶æ‡¶ú ‡¶Ö‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶®‡ßÄ‡¶Ø‡¶º‡•§ ‡¶∏‡¶¨ ‡¶∏‡¶æ‡¶¨‡¶Æ‡¶ø‡¶∂‡¶® ‡¶ì ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶°‡¶æ‡¶ü‡¶æ ‡¶ö‡¶ø‡¶∞‡¶§‡¶∞‡ßá ‡¶Æ‡ßÅ‡¶õ‡ßá ‡¶Ø‡¶æ‡¶¨‡ßá‡•§</p>
      <div class="modal-buttons">
        <button class="modal-btn confirm" id="confirmDelete">
          <i class="fas fa-trash"></i> ‡¶π‡ßç‡¶Ø‡¶æ‡¶Å, ‡¶°‡¶ø‡¶≤‡¶ø‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®
        </button>
        <button class="modal-btn cancel" id="cancelDelete">
          <i class="fas fa-times"></i> ‡¶¨‡¶æ‡¶§‡¶ø‡¶≤
        </button>
      </div>
    </div>
  </div>

  <script>
    (function() {
      // Firebase Config
      const firebaseConfig = {
        apiKey: "AIzaSyCI4HPJ_mqhqmDjKHQr3Cd302rO2Tud1Go",
        authDomain: "mtwork-fc469.firebaseapp.com",
        databaseURL: "https://mtwork-fc469-default-rtdb.firebaseio.com",
        projectId: "mtwork-fc469",
        storageBucket: "mtwork-fc469.firebasestorage.app",
        messagingSenderId: "351935919939",
        appId: "1:351935919939:web:7ad33f6c3e6e4de26f21f6"
      };

      // Initialize Firebase
      let db;
      try {
        firebase.initializeApp(firebaseConfig);
        db = firebase.database();
        console.log("‚úÖ Admin: Firebase ‡¶∏‡¶Ç‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§");
      } catch (e) {
        console.error("‚ùå Admin: Firebase ‡¶§‡ßç‡¶∞‡ßÅ‡¶ü‡¶ø:", e);
      }

      // DOM Elements
      const statusBadge = document.getElementById('statusBadge');
      const toggleSystemBtn = document.getElementById('toggleSystemBtn');
      const tickerMessage = document.getElementById('tickerMessage');
      const offReason = document.getElementById('offReason');
      const updateSystemBtn = document.getElementById('updateSystemBtn');
      const startTime = document.getElementById('startTime');
      const endTime = document.getElementById('endTime');
      const bannerTitle = document.getElementById('bannerTitle');
      const bannerSubtitle = document.getElementById('bannerSubtitle');
      const paymentText = document.getElementById('paymentText');
      const numberPlaceholder = document.getElementById('numberPlaceholder');
      const previewTitle = document.getElementById('previewTitle');
      const previewSubtitle = document.getElementById('previewSubtitle');
      const updateBannerBtn = document.getElementById('updateBannerBtn');
      
      // Stats Elements
      const totalSubmissions = document.getElementById('totalSubmissions');
      const todaySubmissions = document.getElementById('todaySubmissions');
      const totalUsers = document.getElementById('totalUsers');
      const activeToday = document.getElementById('activeToday');
      const avgPerUser = document.getElementById('avgPerUser');
      const maxByUser = document.getElementById('maxByUser');
      const unknownUsers = document.getElementById('unknownUsers');
      
      // Top Users Elements
      const top1Name = document.getElementById('top1Name');
      const top1Count = document.getElementById('top1Count');
      const top2Name = document.getElementById('top2Name');
      const top2Count = document.getElementById('top2Count');
      const top3Name = document.getElementById('top3Name');
      const top3Count = document.getElementById('top3Count');
      
      // Table Elements
      const tableBody = document.getElementById('tableBody');
      const userStatsBody = document.getElementById('userStatsBody');
      const userFilter = document.getElementById('userFilter');
      const toast = document.getElementById('successToast');
      const toastMessage = document.getElementById('toastMessage');
      
      // Buttons
      const exportAllBtn = document.getElementById('exportAllBtn');
      const exportTodayBtn = document.getElementById('exportTodayBtn');
      const exportUserStatsBtn = document.getElementById('exportUserStatsBtn');
      const exportUserStatsExcel = document.getElementById('exportUserStatsExcel');
      const exportFilteredBtn = document.getElementById('exportFilteredBtn');
      const deleteAllBtn = document.getElementById('deleteAllBtn');
      const refreshNowBtn = document.getElementById('refreshNowBtn');
      const refreshInterval = document.getElementById('refreshInterval');
      const deleteModal = document.getElementById('deleteModal');
      const confirmDelete = document.getElementById('confirmDelete');
      const cancelDelete = document.getElementById('cancelDelete');
      const filterBtns = document.querySelectorAll('.filter-btn');

      // State
      let currentFilter = 'all';
      let currentUserFilter = 'all';
      let allData = [];
      let userStats = {};
      let systemStatus = true;
      let hourlyChart, topUsersChart;

      // Show Toast
      function showToast(message) {
        toastMessage.textContent = message;
        toast.classList.add('show');
        setTimeout(() => {
          toast.classList.remove('show');
        }, 3000);
      }

      // Load System Settings
      function loadSystemSettings() {
        if (!db) return;
        
        db.ref("system_control").on("value", (snapshot) => {
          if (snapshot.exists()) {
            const data = snapshot.val();
            systemStatus = data.status !== undefined ? data.status : true;
            tickerMessage.value = data.ticker_message || 'üîπ ROG TEAM - FACEBOOK 2FA ‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ üîπ';
            offReason.value = data.off_reason || '';
            
            // Load time settings
            if (data.start_time) startTime.value = data.start_time;
            if (data.end_time) endTime.value = data.end_time;
            
            // Load banner settings
            if (data.banner_title) {
              bannerTitle.value = data.banner_title;
              previewTitle.textContent = data.banner_title;
            }
            if (data.banner_subtitle) {
              bannerSubtitle.value = data.banner_subtitle;
              previewSubtitle.textContent = data.banner_subtitle;
            }
            if (data.payment_text) paymentText.value = data.payment_text;
            if (data.number_placeholder) numberPlaceholder.value = data.number_placeholder;
            
            updateStatusUI();
          }
        });
      }

      function updateStatusUI() {
        if (systemStatus) {
          statusBadge.textContent = '‚úÖ ‡¶ö‡¶æ‡¶≤‡ßÅ';
          statusBadge.className = 'status-badge on';
          toggleSystemBtn.textContent = '‡¶¨‡¶®‡ßç‡¶ß ‡¶ï‡¶∞‡ßÅ‡¶®';
          toggleSystemBtn.className = 'toggle-btn on';
        } else {
          statusBadge.textContent = 'üî¥ ‡¶¨‡¶®‡ßç‡¶ß';
          statusBadge.className = 'status-badge off';
          toggleSystemBtn.textContent = '‡¶ö‡¶æ‡¶≤‡ßÅ ‡¶ï‡¶∞‡ßÅ‡¶®';
          toggleSystemBtn.className = 'toggle-btn off';
        }
      }

      // Toggle System
      toggleSystemBtn.addEventListener('click', async () => {
        if (!db) return;
        
        const newStatus = !systemStatus;
        try {
          await db.ref("system_control").update({
            status: newStatus,
            ticker_message: tickerMessage.value,
            off_reason: offReason.value,
            start_time: startTime.value,
            end_time: endTime.value
          });
          showToast('‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶æ‡¶∏ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá');
        } catch (error) {
          alert('‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá: ' + error.message);
        }
      });

      // Update System
      updateSystemBtn.addEventListener('click', async () => {
        if (!db) return;
        
        try {
          await db.ref("system_control").update({
            status: systemStatus,
            ticker_message: tickerMessage.value,
            off_reason: offReason.value,
            start_time: startTime.value,
            end_time: endTime.value
          });
          showToast('‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ ‡¶∏‡ßá‡¶ü‡¶ø‡¶Ç‡¶∏ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá');
        } catch (error) {
          alert('‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá: ' + error.message);
        }
      });

      // Update Banner
      updateBannerBtn.addEventListener('click', async () => {
        if (!db) return;
        
        previewTitle.textContent = bannerTitle.value;
        previewSubtitle.textContent = bannerSubtitle.value;
        
        try {
          await db.ref("system_control").update({
            banner_title: bannerTitle.value,
            banner_subtitle: bannerSubtitle.value,
            payment_text: paymentText.value,
            number_placeholder: numberPlaceholder.value
          });
          showToast('‡¶¨‡ßç‡¶Ø‡¶æ‡¶®‡¶æ‡¶∞ ‡¶∏‡ßá‡¶ü‡¶ø‡¶Ç‡¶∏ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá');
        } catch (error) {
          alert('‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá: ' + error.message);
        }
      });

      // Load Data
      function loadData() {
        if (!db) return;
        
        db.ref("instagram_2fa_submissions").on("value", (snapshot) => {
          if (snapshot.exists()) {
            const data = snapshot.val();
            allData = Object.entries(data).map(([id, item]) => ({
              id,
              ...item,
              user_token: item.user_token || 'Unknown',
              submitted_at: item.submitted_at || new Date().toISOString()
            })).sort((a, b) => new Date(b.submitted_at) - new Date(a.submitted_at));
            
            calculateUserStats();
            updateFilterOptions();
            updateStats();
            updateTopUsers();
            renderTable();
            renderUserStats();
            updateCharts();
          } else {
            allData = [];
            userStats = {};
            tableBody.innerHTML = '<tr><td colspan="6" class="no-data">üì≠ ‡¶ï‡ßã‡¶® ‡¶°‡¶æ‡¶ü‡¶æ ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø</td></tr>';
            userStatsBody.innerHTML = '<tr><td colspan="6" class="no-data">üì≠ ‡¶ï‡ßã‡¶® ‡¶°‡¶æ‡¶ü‡¶æ ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø</td></tr>';
            resetStats();
          }
        });
      }

      function calculateUserStats() {
        userStats = {};
        let unknownCount = 0;
        
        allData.forEach(item => {
          const token = item.user_token || 'Unknown';
          if (!userStats[token]) {
            userStats[token] = {
              total: 0,
              today: 0,
              lastSubmission: item.submitted_at,
              submissions: []
            };
          }
          
          userStats[token].total++;
          userStats[token].submissions.push(item);
          
          const today = new Date().toDateString();
          const itemDate = new Date(item.submitted_at).toDateString();
          if (itemDate === today) {
            userStats[token].today++;
          }
          
          if (new Date(item.submitted_at) > new Date(userStats[token].lastSubmission)) {
            userStats[token].lastSubmission = item.submitted_at;
          }

          if (token === 'Unknown') {
            unknownCount++;
          }
        });

        if (unknownUsers) {
          unknownUsers.textContent = unknownCount;
        }
      }

      function updateTopUsers() {
        const sortedUsers = Object.entries(userStats)
          .filter(([token]) => token !== 'Unknown')
          .sort((a, b) => b[1].total - a[1].total);
        
        if (sortedUsers.length > 0) {
          top1Name.textContent = sortedUsers[0][0].substring(0, 15) + '...';
          top1Count.textContent = sortedUsers[0][1].total;
        } else {
          top1Name.textContent = '-';
          top1Count.textContent = '0';
        }
        
        if (sortedUsers.length > 1) {
          top2Name.textContent = sortedUsers[1][0].substring(0, 15) + '...';
          top2Count.textContent = sortedUsers[1][1].total;
        } else {
          top2Name.textContent = '-';
          top2Count.textContent = '0';
        }
        
        if (sortedUsers.length > 2) {
          top3Name.textContent = sortedUsers[2][0].substring(0, 15) + '...';
          top3Count.textContent = sortedUsers[2][1].total;
        } else {
          top3Name.textContent = '-';
          top3Count.textContent = '0';
        }
      }

      function updateFilterOptions() {
        let options = '<option value="all">‡¶∏‡¶¨ ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡ßá‡¶∞ ‡¶°‡¶æ‡¶ü‡¶æ</option>';
        
        Object.keys(userStats).sort().forEach(token => {
          const displayToken = token === 'Unknown' ? '‚ö†Ô∏è Unknown (‡¶™‡ßÅ‡¶∞‡¶®‡ßã ‡¶°‡¶æ‡¶ü‡¶æ)' : token.substring(0, 15) + '...';
          options += `<option value="${token}">${displayToken} (${userStats[token].total}‡¶ü‡¶ø)</option>`;
        });
        
        userFilter.innerHTML = options;
      }

      function resetStats() {
        totalSubmissions.textContent = '0';
        todaySubmissions.textContent = '0';
        totalUsers.textContent = '0';
        activeToday.textContent = '0 ‡¶è‡¶ï‡¶ü‡¶ø‡¶≠';
        avgPerUser.textContent = '0';
        maxByUser.textContent = '0';
        unknownUsers.textContent = '0';
      }

      function updateStats() {
        totalSubmissions.textContent = allData.length;
        
        const today = new Date().toDateString();
        const todayData = allData.filter(item => {
          const itemDate = new Date(item.submitted_at).toDateString();
          return itemDate === today;
        });
        todaySubmissions.textContent = todayData.length;
        
        const userCount = Object.keys(userStats).length;
        totalUsers.textContent = userCount;
        
        const activeTodayCount = Object.values(userStats).filter(u => u.today > 0).length;
        activeToday.textContent = activeTodayCount + ' ‡¶è‡¶ï‡¶ü‡¶ø‡¶≠';
        
        const avg = userCount > 0 ? (allData.length / userCount).toFixed(1) : 0;
        avgPerUser.textContent = avg;
        
        const max = userCount > 0 ? Math.max(...Object.values(userStats).map(u => u.total)) : 0;
        maxByUser.textContent = max;
      }

      function renderUserStats() {
        if (Object.keys(userStats).length === 0) {
          userStatsBody.innerHTML = '<tr><td colspan="6" class="no-data">üì≠ ‡¶ï‡ßã‡¶® ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶°‡¶æ‡¶ü‡¶æ ‡¶®‡ßá‡¶á</td></tr>';
          return;
        }
        
        let html = '';
        let index = 1;
        
        Object.entries(userStats)
          .sort((a, b) => b[1].total - a[1].total)
          .forEach(([token, stats]) => {
            const lastDate = new Date(stats.lastSubmission);
            const formattedLast = `${lastDate.getDate()}/${lastDate.getMonth()+1} ${lastDate.getHours()}:${String(lastDate.getMinutes()).padStart(2,'0')}`;
            
            html += `
              <tr>
                <td>${index++}</td>
                <td>
                  <span class="token-badge ${token === 'Unknown' ? 'unknown' : ''}">
                    ${token === 'Unknown' ? '‚ö†Ô∏è Unknown' : token.substring(0, 20) + '...'}
                  </span>
                </td>
                <td><span class="user-badge total">${stats.total}‡¶ü‡¶ø</span></td>
                <td><span class="user-badge today">${stats.today}‡¶ü‡¶ø</span></td>
                <td>${formattedLast}</td>
                <td>
                  <button class="filter-btn" style="padding: 8px 15px;" onclick="filterByUser('${token}')">
                    <i class="fas fa-eye"></i>
                  </button>
                </td>
              </tr>
            `;
          });
        
        userStatsBody.innerHTML = html;
      }

      window.filterByUser = function(token) {
        userFilter.value = token;
        currentUserFilter = token;
        renderTable();
      };

      function renderTable() {
        let filteredData = allData;
        
        if (currentUserFilter !== 'all') {
          filteredData = filteredData.filter(item => (item.user_token || 'Unknown') === currentUserFilter);
        }
        
        if (currentFilter === 'today') {
          const today = new Date().toDateString();
          filteredData = filteredData.filter(item => {
            const itemDate = new Date(item.submitted_at).toDateString();
            return itemDate === today;
          });
        }
        
        if (filteredData.length === 0) {
          tableBody.innerHTML = '<tr><td colspan="6" class="no-data">üì≠ ‡¶ï‡ßã‡¶® ‡¶°‡¶æ‡¶ü‡¶æ ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø</td></tr>';
          return;
        }
        
        let html = '';
        filteredData.forEach((item, index) => {
          const date = new Date(item.submitted_at);
          const formattedDate = `${date.getDate()}/${date.getMonth()+1}/${date.getFullYear()} ${date.getHours()}:${String(date.getMinutes()).padStart(2,'0')}`;
          
          html += `
            <tr>
              <td>${index + 1}</td>
              <td><strong>${item.username || 'N/A'}</strong></td>
              <td>${item.password || 'N/A'}</td>
              <td>${item.fa_key || item.cookie_2fa || 'N/A'}</td>
              <td><span class="token-badge ${!item.user_token || item.user_token === 'Unknown' ? 'unknown' : ''}">
                ${!item.user_token || item.user_token === 'Unknown' ? '‚ö†Ô∏è Unknown' : item.user_token.substring(0, 15) + '...'}
              </span></td>
              <td>${formattedDate}</td>
            </tr>
          `;
        });
        
        tableBody.innerHTML = html;
      }

      function updateCharts() {
        if (!document.getElementById('hourlyChart') || !document.getElementById('topUsersChart')) return;
        
        // Hourly Chart
        const today = new Date().toDateString();
        const todayData = allData.filter(item => {
          const itemDate = new Date(item.submitted_at).toDateString();
          return itemDate === today;
        });
        
        const hourlyCounts = new Array(24).fill(0);
        todayData.forEach(item => {
          const hour = new Date(item.submitted_at).getHours();
          hourlyCounts[hour]++;
        });

        if (hourlyChart) hourlyChart.destroy();
        const ctx1 = document.getElementById('hourlyChart').getContext('2d');
        hourlyChart = new Chart(ctx1, {
          type: 'line',
          data: {
            labels: Array.from({length: 24}, (_, i) => i + '‡¶ü‡¶æ'),
            datasets: [{
              label: '‡¶∏‡¶æ‡¶¨‡¶Æ‡¶ø‡¶∂‡¶®',
              data: hourlyCounts,
              borderColor: '#667eea',
              backgroundColor: 'rgba(102, 126, 234, 0.1)',
              tension: 0.4,
              fill: true
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              legend: { display: false }
            }
          }
        });

        // Top Users Chart
        const topUsersData = Object.entries(userStats)
          .filter(([token]) => token !== 'Unknown')
          .sort((a, b) => b[1].total - a[1].total)
          .slice(0, 5);

        if (topUsersChart) topUsersChart.destroy();
        const ctx2 = document.getElementById('topUsersChart').getContext('2d');
        topUsersChart = new Chart(ctx2, {
          type: 'bar',
          data: {
            labels: topUsersData.map(([token]) => token.substring(0, 10) + '...'),
            datasets: [{
              label: '‡¶Æ‡ßã‡¶ü ‡¶∏‡¶æ‡¶¨‡¶Æ‡¶ø‡¶∂‡¶®',
              data: topUsersData.map(([, stats]) => stats.total),
              backgroundColor: '#667eea'
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              legend: { display: false }
            }
          }
        });
      }

      // Export Functions
      function exportToExcel(filterType, userFilter = 'all') {
        let dataToExport = allData;
        
        if (userFilter !== 'all') {
          dataToExport = dataToExport.filter(item => (item.user_token || 'Unknown') === userFilter);
        }
        
        if (filterType === 'today') {
          const today = new Date().toDateString();
          dataToExport = dataToExport.filter(item => {
            const itemDate = new Date(item.submitted_at).toDateString();
            return itemDate === today;
          });
        }
        
        if (dataToExport.length === 0) {
          alert('‡¶ï‡ßã‡¶® ‡¶°‡¶æ‡¶ü‡¶æ ‡¶®‡ßá‡¶á!');
          return;
        }
        
        const excelData = dataToExport.map(item => [
          item.username || '',
          item.password || '',
          item.fa_key || item.cookie_2fa || '',
          item.user_token || 'Unknown',
          new Date(item.submitted_at).toLocaleString('bn-BD')
        ]);
        
        excelData.unshift(['UID', '‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶°', '2FA KEY', '‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶ü‡ßã‡¶ï‡ßá‡¶®', '‡¶∏‡¶æ‡¶¨‡¶Æ‡¶ø‡¶∂‡¶® ‡¶∏‡¶Æ‡¶Ø‡¶º']);
        
        const wb = XLSX.utils.book_new();
        const ws = XLSX.utils.aoa_to_sheet(excelData);
        XLSX.utils.book_append_sheet(wb, ws, 'Facebook 2FA Data');
        
        let fileName = `facebook_2fa_${filterType}`;
        if (userFilter !== 'all') {
          fileName += `_${userFilter === 'Unknown' ? 'unknown' : userFilter.substring(0, 8)}`;
        }
        fileName += `_${new Date().toISOString().split('T')[0]}.xlsx`;
        
        XLSX.writeFile(wb, fileName);
        showToast('‡¶è‡¶ï‡ßç‡¶∏‡ßá‡¶≤ ‡¶´‡¶æ‡¶á‡¶≤ ‡¶°‡¶æ‡¶â‡¶®‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...');
      }

      function exportUserStats() {
        if (Object.keys(userStats).length === 0) {
          alert('‡¶ï‡ßã‡¶® ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶°‡¶æ‡¶ü‡¶æ ‡¶®‡ßá‡¶á!');
          return;
        }
        
        const excelData = Object.entries(userStats).map(([token, stats]) => [
          token,
          stats.total,
          stats.today,
          new Date(stats.lastSubmission).toLocaleString('bn-BD')
        ]);
        
        excelData.unshift(['‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶ü‡ßã‡¶ï‡ßá‡¶®', '‡¶Æ‡ßã‡¶ü ‡¶∏‡¶æ‡¶¨‡¶Æ‡¶ø‡¶∂‡¶®', '‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶∏‡¶æ‡¶¨‡¶Æ‡¶ø‡¶∂‡¶®', '‡¶∏‡¶∞‡ßç‡¶¨‡¶∂‡ßá‡¶∑ ‡¶∏‡¶æ‡¶¨‡¶Æ‡¶ø‡¶∂‡¶®']);
        
        const wb = XLSX.utils.book_new();
        const ws = XLSX.utils.aoa_to_sheet(excelData);
        XLSX.utils.book_append_sheet(wb, ws, 'User Statistics');
        XLSX.writeFile(wb, `user_stats_${new Date().toISOString().split('T')[0]}.xlsx`);
        showToast('‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶∏ ‡¶è‡¶ï‡ßç‡¶∏‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá');
      }

      // Delete All Data
      async function deleteAllData() {
        if (!db) return;
        
        try {
          await db.ref("instagram_2fa_submissions").remove();
          await db.ref("instagram_used_usernames").remove();
          deleteModal.classList.remove('active');
          showToast('‡¶∏‡¶¨ ‡¶°‡¶æ‡¶ü‡¶æ ‡¶°‡¶ø‡¶≤‡¶ø‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá');
        } catch (error) {
          alert('‡¶°‡¶ø‡¶≤‡¶ø‡¶ü ‡¶ï‡¶∞‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá: ' + error.message);
        }
      }

      // Event Listeners
      exportAllBtn.addEventListener('click', () => exportToExcel('all'));
      exportTodayBtn.addEventListener('click', () => exportToExcel('today'));
      exportUserStatsBtn.addEventListener('click', exportUserStats);
      exportUserStatsExcel.addEventListener('click', exportUserStats);
      
      exportFilteredBtn.addEventListener('click', () => {
        exportToExcel(currentFilter, currentUserFilter);
      });

      userFilter.addEventListener('change', (e) => {
        currentUserFilter = e.target.value;
        renderTable();
      });

      filterBtns.forEach(btn => {
        btn.addEventListener('click', () => {
          filterBtns.forEach(b => b.classList.remove('active'));
          btn.classList.add('active');
          currentFilter = btn.dataset.filter;
          renderTable();
        });
      });

      refreshNowBtn.addEventListener('click', () => {
        loadData();
        showToast('‡¶°‡¶æ‡¶ü‡¶æ ‡¶∞‡¶ø‡¶´‡ßç‡¶∞‡ßá‡¶∂ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá');
      });

      deleteAllBtn.addEventListener('click', () => {
        if (allData.length === 0) {
          alert('‡¶ï‡ßã‡¶® ‡¶°‡¶æ‡¶ü‡¶æ ‡¶®‡ßá‡¶á!');
          return;
        }
        deleteModal.classList.add('active');
      });

      confirmDelete.addEventListener('click', deleteAllData);
      
      cancelDelete.addEventListener('click', () => {
        deleteModal.classList.remove('active');
      });

      deleteModal.addEventListener('click', (e) => {
        if (e.target === deleteModal) {
          deleteModal.classList.remove('active');
        }
      });

      // Initialize
      loadSystemSettings();
      loadData();

      // Auto Refresh
      setInterval(() => {
        loadData();
      }, (parseInt(refreshInterval.value) || 30) * 1000);
    })();
  </script>
</body>
</html>